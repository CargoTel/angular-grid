!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs"],e):e((t.ng=t.ng||{},t.ng.grid=t.ng.grid||{}),t.ng.core,t.rxjs)}(this,function(t,e,i){"use strict";var n=function(){function t(t,e){this._ngEl=t,this._renderer=e}return t.prototype.registerGrid=function(t){this._ngGrid=t},t.prototype.ngOnInit=function(){this._renderer.addClass(this._ngEl.nativeElement,"grid-placeholder"),this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"position","absolute")},t.prototype.setSize=function(t){this._size=t,this._recalculateDimensions()},t.prototype.setGridPosition=function(t){this._position=t,this._recalculatePosition()},t.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t,t){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"right","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"top","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"left",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"left","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"bottom","0px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"top",null)}},t.prototype._setDimensions=function(t,e){this._renderer.setStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"height",e+"px")},t.prototype._setPosition=function(t,e){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+e+"px)");break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"transform","translate("+-t+"px, "+e+"px)");break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"transform","translate("+t+"px, "+-e+"px)")}},t.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._position.col-1)+this._ngGrid.marginLeft+this._ngGrid.screenMargin,e=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._position.row-1)+this._ngGrid.marginTop;this._setPosition(t,e)},t.prototype._recalculateDimensions=function(){var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),e=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1);this._setDimensions(t,e)},t.ɵfac=function(i){return new(i||t)(e.ɵɵdirectiveInject(e.ElementRef),e.ɵɵdirectiveInject(e.Renderer2))},t.ɵcmp=e.ɵɵdefineComponent({type:t,selectors:[["ng-grid-placeholder"]],decls:0,vars:0,template:function(t,e){},encapsulation:2}),t}();!function(){("undefined"==typeof ngDevMode||ngDevMode)&&e.ɵsetClassMetadata(n,[{type:e.Component,args:[{selector:"ng-grid-placeholder",template:""}]}],function(){return[{type:e.ElementRef},{type:e.Renderer2}]},null)}();var s=function(){function t(){}return t.generateUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t.sortItemsByPositionHorizontal=function(t,e){return t.col===e.col?t.row-e.row:t.col-e.col},t.sortItemsByPositionVertical=function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row},t}(),o=function(){function t(i,n,s,o){this._differs=i,this._ngEl=n,this._renderer=s,this.componentFactoryResolver=o,this.onDragStart=new e.EventEmitter,this.onDrag=new e.EventEmitter,this.onDragStop=new e.EventEmitter,this.onResizeStart=new e.EventEmitter,this.onResize=new e.EventEmitter,this.onResizeStop=new e.EventEmitter,this.onItemChange=new e.EventEmitter,this.colWidth=250,this.rowHeight=250,this.minCols=1,this.minRows=1,this.marginTop=10,this.marginRight=10,this.marginBottom=10,this.marginLeft=10,this.screenMargin=0,this.isDragging=!1,this.isResizing=!1,this.autoStyle=!0,this.resizeEnable=!0,this.dragEnable=!0,this.cascade="up",this.minWidth=100,this.minHeight=100,this.resizeDirections=t.CONST_DEFAULT_RESIZE_DIRECTIONS,this._items=new Map,this._draggingItem=null,this._resizingItem=null,this._resizeDirection=null,this._itemsInGrid=new Set,this._maxCols=0,this._maxRows=0,this._visibleCols=0,this._visibleRows=0,this._posOffset=null,this._placeholderRef=null,this._fixToGrid=!1,this._autoResize=!1,this._destroyed=!1,this._maintainRatio=!1,this._preferNew=!1,this._zoomOnDrag=!1,this._limitToScreen=!1,this._centerToScreen=!1,this._curMaxRow=0,this._curMaxCol=0,this._dragReady=!1,this._resizeReady=!1,this._elementBasedDynamicRowHeight=!1,this._itemFixDirection="cascade",this._collisionFixDirection="cascade",this._allowOverlap=!1,this._lastZValue=1,this._subscriptions=[],this._enabledListener=!1,this._config=t.CONST_DEFAULT_CONFIG,this._defineListeners()}return Object.defineProperty(t.prototype,"config",{set:function(t){null!=t&&"object"==typeof t&&(this.setConfig(t),null==this._differ&&null!=t&&(this._differ=this._differs.find(this._config).create()),this._differ.diff(this._config))},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this._renderer.addClass(this._ngEl.nativeElement,"grid"),this.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"position","relative"),this.setConfig(this._config)},t.prototype.ngOnDestroy=function(){this._destroyed=!0,this._disableListeners()},t.prototype.generateItemUid=function(){var t=s.generateUuid();return this._items.has(t)?this.generateItemUid():t},t.prototype.setConfig=function(t){var e=this;this._config=t;var i=!1;for(var n in t)if(n in t){var s=t[n],o=s?parseInt(s,10):0;switch(n){case"margins":this.setMargins(s);break;case"col_width":this.colWidth=Math.max(o,1);break;case"row_height":this.rowHeight=Math.max(o,1);break;case"auto_style":this.autoStyle=!!s;break;case"auto_resize":this._autoResize=!!s;break;case"draggable":this.dragEnable=!!s;break;case"resizable":this.resizeEnable=!!s;break;case"max_rows":i=i||this._maxRows!==o,this._maxRows=o<0?0:o;break;case"max_cols":i=i||this._maxCols!==o,this._maxCols=o<0?0:o;break;case"visible_rows":this._visibleRows=Math.max(o,0);break;case"visible_cols":this._visibleCols=Math.max(o,0);break;case"min_rows":this.minRows=Math.max(o,1);break;case"min_cols":this.minCols=Math.max(o,1);break;case"min_height":this.minHeight=Math.max(o,1);break;case"min_width":this.minWidth=Math.max(o,1);break;case"zoom_on_drag":this._zoomOnDrag=!!s;break;case"cascade":this.cascade!==s&&(this.cascade=s,this._cascadeGrid());break;case"fix_to_grid":this._fixToGrid=!!s;break;case"maintain_ratio":this._maintainRatio=!!s;break;case"prefer_new":this._preferNew=!!s;break;case"limit_to_screen":this._limitToScreen=!this._autoResize&&!!s;break;case"center_to_screen":this._centerToScreen=!!s;break;case"resize_directions":this.resizeDirections=s||["bottomright","bottomleft","topright","topleft","right","left","bottom","top"];break;case"element_based_row_height":this._elementBasedDynamicRowHeight=!!s;break;case"fix_item_position_direction":this._itemFixDirection=s;break;case"fix_collision_position_direction":this._collisionFixDirection=s;break;case"allow_overlap":this._allowOverlap=!!s}}if(this._allowOverlap&&"off"!==this.cascade&&""!==this.cascade&&(console.warn("Unable to overlap items when a cascade direction is set."),this._allowOverlap=!1),this.dragEnable||this.resizeEnable?this._enableListeners():this._disableListeners(),"cascade"===this._itemFixDirection&&(this._itemFixDirection=this._getFixDirectionFromCascade()),"cascade"===this._collisionFixDirection&&(this._collisionFixDirection=this._getFixDirectionFromCascade()),this._limitToScreen){var r=this._getContainerColumns();this._maxCols!==r&&(this._maxCols=r,i=!0)}if(this._limitToScreen&&this._centerToScreen?this.screenMargin=this._getScreenMargin():this.screenMargin=0,this._maintainRatio&&(this.colWidth&&this.rowHeight?this._aspectRatio=this.colWidth/this.rowHeight:this._maintainRatio=!1),i){if(this._maxCols>0&&this._maxRows>0)switch(this.cascade){case"left":case"right":this._maxCols=0;break;case"up":case"down":default:this._maxRows=0}this._updatePositionsAfterMaxChange()}this._calculateColWidth(),this._calculateRowHeight();var h=this._maxCols*this.colWidth,a=this._maxRows*this.rowHeight;h>0&&this.minWidth>h&&(this.minWidth=.75*this.colWidth),a>0&&this.minHeight>a&&(this.minHeight=.75*this.rowHeight),this.minWidth>this.colWidth&&(this.minCols=Math.max(this.minCols,Math.ceil(this.minWidth/this.colWidth))),this.minHeight>this.rowHeight&&(this.minRows=Math.max(this.minRows,Math.ceil(this.minHeight/this.rowHeight))),this._maxCols>0&&this.minCols>this._maxCols&&(this.minCols=1),this._maxRows>0&&this.minRows>this._maxRows&&(this.minRows=1),this._updateRatio(),this._items.forEach(function(t){e._removeFromGrid(t),t.setCascadeMode(e.cascade)}),this._items.forEach(function(t){t.recalculateSelf(),e._addToGrid(t)}),this._cascadeGrid(),this._updateSize()},t.prototype.getItemPosition=function(t){return this._items.has(t)?this._items.get(t).getGridPosition():null},t.prototype.getItemSize=function(t){return this._items.has(t)?this._items.get(t).getSize():null},t.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._config);if(null!=t)return this._applyChanges(t),!0}return!1},t.prototype.setMargins=function(t){this.marginTop=Math.max(parseInt(t[0],10),0),this.marginRight=t.length>=2?Math.max(parseInt(t[1],10),0):this.marginTop,this.marginBottom=t.length>=3?Math.max(parseInt(t[2],10),0):this.marginTop,this.marginLeft=t.length>=4?Math.max(parseInt(t[3],10),0):this.marginRight},t.prototype.enableDrag=function(){this.dragEnable=!0},t.prototype.disableDrag=function(){this.dragEnable=!1},t.prototype.enableResize=function(){this.resizeEnable=!0},t.prototype.disableResize=function(){this.resizeEnable=!1},t.prototype.addItem=function(t){var e=this;if(t.setCascadeMode(this.cascade),!this._preferNew){var i=this._fixGridPosition(t.getGridPosition(),t.getSize());t.setGridPosition(i)}(null===t.uid||this._items.has(t.uid))&&(t.uid=this.generateItemUid()),this._items.set(t.uid,t),this._addToGrid(t),this._updateSize(),this.triggerCascade().then(function(){t.recalculateSelf(),t.onCascadeEvent(),e._emitOnItemChange()})},t.prototype.removeItem=function(t){var e=this;this._removeFromGrid(t),this._items.delete(t.uid),this._destroyed||this.triggerCascade().then(function(){e._updateSize(),e._items.forEach(function(t){return t.recalculateSelf()}),e._emitOnItemChange()})},t.prototype.updateItem=function(t){var e=this;this._removeFromGrid(t),this._addToGrid(t),this.triggerCascade().then(function(){e._updateSize(),t.onCascadeEvent()})},t.prototype.triggerCascade=function(){var t=this;return this._cascadePromise||(this._cascadePromise=new Promise(function(e){setTimeout(function(){t._cascadePromise=null,t._cascadeGrid(null,null),e()},0)})),this._cascadePromise},t.prototype.triggerResize=function(){this.resizeEventHandler(null)},t.prototype.resizeEventHandler=function(t){if(this._calculateColWidth(),this._calculateRowHeight(),this._updateRatio(),this._limitToScreen){var e=this._getContainerColumns();this._maxCols!==e&&(this._maxCols=e,this._updatePositionsAfterMaxChange(),this._cascadeGrid()),this._centerToScreen&&(this.screenMargin=this._getScreenMargin(),this._items.forEach(function(t){t.recalculateSelf()}))}else this._autoResize&&this._items.forEach(function(t){t.recalculateSelf()});this._updateSize()},t.prototype.mouseDownEventHandler=function(t){var e=this._getMousePosition(t),i=this._getItemFromPosition(e);if(null!=i){var n=i.canResize(t);if(this.resizeEnable&&n)this._resizeReady=!0,this._resizingItem=i,this._resizeDirection=n,t.preventDefault();else if(this.dragEnable&&i.canDrag(t)){this._dragReady=!0,this._draggingItem=i;var s=i.getPosition();this._posOffset={left:e.left-s.left,top:e.top-s.top},t.preventDefault()}}},t.prototype.mouseUpEventHandler=function(t){this.isDragging?this._dragStop(t):this.isResizing?this._resizeStop(t):(this._dragReady||this._resizeReady)&&(this._cleanDrag(),this._cleanResize())},t.prototype.mouseMoveEventHandler=function(t){if(this._resizeReady)return this._resizeStart(t),void t.preventDefault();if(this._dragReady)return this._dragStart(t),void t.preventDefault();if(this.isDragging)this._drag(t);else if(this.isResizing)this._resize(t);else{var e=this._getMousePosition(t),i=this._getItemFromPosition(e);i&&i.onMouseMove(t)}},t.prototype._getFixDirectionFromCascade=function(){switch(this.cascade){case"up":case"down":default:return"vertical";case"left":case"right":return"horizontal"}},t.prototype._updatePositionsAfterMaxChange=function(){var t=this;this._items.forEach(function(e){var i=e.getGridPosition(),n=e.getSize();if(!(!t._hasGridCollision(i,n)&&t._isWithinBounds(i,n)&&n.x<=t._maxCols&&n.y<=t._maxRows)){if(t._removeFromGrid(e),t._maxCols>0&&n.x>t._maxCols?(n.x=t._maxCols,e.setSize(n)):t._maxRows>0&&n.y>t._maxRows&&(n.y=t._maxRows,e.setSize(n)),t._hasGridCollision(i,n)||!t._isWithinBounds(i,n,!0)){var s=t._fixGridPosition(i,n);e.setGridPosition(s)}t._addToGrid(e)}})},t.prototype._calculateColWidth=function(){if(this._autoResize&&(this._maxCols>0||this._visibleCols>0)){var t=this._maxCols>0?this._maxCols:this._visibleCols,e=this._ngEl.nativeElement.getBoundingClientRect().width,i=Math.floor(e/t);i-=this.marginLeft+this.marginRight,i>0&&(this.colWidth=i)}(this.colWidth<this.minWidth||this.minCols>this._config.min_cols)&&(this.minCols=Math.max(this._config.min_cols,Math.ceil(this.minWidth/this.colWidth)))},t.prototype._calculateRowHeight=function(){if(this._autoResize&&(this._maxRows>0||this._visibleRows>0)){var t=this._maxRows>0?this._maxRows:this._visibleRows,e=void 0;e=this._elementBasedDynamicRowHeight?this._ngEl.nativeElement.getBoundingClientRect().height:window.innerHeight-this.marginTop-this.marginBottom;var i=Math.max(Math.floor(e/t),this.minHeight);i-=this.marginTop+this.marginBottom,i>0&&(this.rowHeight=i)}(this.rowHeight<this.minHeight||this.minRows>this._config.min_rows)&&(this.minRows=Math.max(this._config.min_rows,Math.ceil(this.minHeight/this.rowHeight)))},t.prototype._updateRatio=function(){this._autoResize&&this._maintainRatio&&(this._maxCols>0&&this._visibleRows<=0?this.rowHeight=this.colWidth/this._aspectRatio:this._maxRows>0&&this._visibleCols<=0?this.colWidth=this._aspectRatio*this.rowHeight:0===this._maxCols&&0===this._maxRows&&(this._visibleCols>0?this.rowHeight=this.colWidth/this._aspectRatio:this._visibleRows>0&&(this.colWidth=this._aspectRatio*this.rowHeight)))},t.prototype._applyChanges=function(t){var e=this;t.forEachAddedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachChangedItem(function(t){e._config[t.key]=t.currentValue}),t.forEachRemovedItem(function(t){delete e._config[t.key]}),this.setConfig(this._config)},t.prototype._resizeStart=function(t){this.resizeEnable&&this._resizingItem&&(this._resizingItem.startMoving(),this._removeFromGrid(this._resizingItem),this._createPlaceholder(this._resizingItem),this._allowOverlap&&(this._resizingItem.zIndex=this._lastZValue++),this.isResizing=!0,this._resizeReady=!1,this.onResizeStart.emit(this._resizingItem),this._resizingItem.onResizeStartEvent())},t.prototype._dragStart=function(t){this.dragEnable&&this._draggingItem&&(this._draggingItem.startMoving(),this._removeFromGrid(this._draggingItem),this._createPlaceholder(this._draggingItem),this._allowOverlap&&(this._draggingItem.zIndex=this._lastZValue++),this.isDragging=!0,this._dragReady=!1,this.onDragStart.emit(this._draggingItem),this._draggingItem.onDragStartEvent(),this._zoomOnDrag&&this._zoomOut())},t.prototype._zoomOut=function(){this._renderer.setStyle(this._ngEl.nativeElement,"transform","scale(0.5, 0.5)")},t.prototype._resetZoom=function(){this._renderer.setStyle(this._ngEl.nativeElement,"transform","")},t.prototype._drag=function(t){if(this.isDragging){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var e=this._getMousePosition(t),i=e.left-this._posOffset.left,n=e.top-this._posOffset.top,s=this._draggingItem.getGridPosition(),o=this._calculateGridPosition(i,n),r=this._draggingItem.getSize();o=this._fixPosToBoundsX(o,r),this._isWithinBoundsY(o,r)||(o=this._fixPosToBoundsY(o,r)),o.col===s.col&&o.row===s.row||(this._draggingItem.setGridPosition(o,this._fixToGrid),this._placeholderRef.instance.setGridPosition(o),["up","down","left","right"].indexOf(this.cascade)>=0&&(this._fixGridCollisions(o,r),this._cascadeGrid(o,r))),this._fixToGrid||this._draggingItem.setPosition(i,n),this.onDrag.emit(this._draggingItem),this._draggingItem.onDragEvent()}},t.prototype._resize=function(t){if(this.isResizing){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();var e=this._getMousePosition(t),i=this._resizingItem.getPosition(),n=this._resizingItem.getDimensions(),s={left:i.left+n.width,top:i.top+n.height},o=this._resizeDirection.includes("top"),r=this._resizeDirection.includes("bottom"),h=this._resizeDirection.includes("left"),a=this._resizeDirection.includes("right"),l=a?e.left-i.left+1:h?s.left-e.left+1:n.width,c=r?e.top-i.top+1:o?s.top-e.top+1:n.height;l<this.minWidth&&(l=this.minWidth),c<this.minHeight&&(c=this.minHeight),l<this._resizingItem.minWidth&&(l=this._resizingItem.minWidth),c<this._resizingItem.minHeight&&(c=this._resizingItem.minHeight);var _=i.left,g=i.top;h&&(_=s.left-l),o&&(g=s.top-c);var d=this._calculateGridSize(l,c),m=this._resizingItem.getSize(),u=this._resizingItem.getGridPosition(),f={col:u.col+m.x,row:u.row+m.y},p=Object.assign({},u);this._resizeDirection.includes("top")&&(p.row=f.row-d.y),this._resizeDirection.includes("left")&&(p.col=f.col-d.x),this._isWithinBoundsX(p,d)||(d=this._fixSizeToBoundsX(p,d)),this._isWithinBoundsY(p,d)||(d=this._fixSizeToBoundsY(p,d)),d=this._resizingItem.fixResize(d),d.x===m.x&&d.y===m.y||(this._resizingItem.setGridPosition(p,this._fixToGrid),this._placeholderRef.instance.setGridPosition(p),this._resizingItem.setSize(d,this._fixToGrid),this._placeholderRef.instance.setSize(d),["up","down","left","right"].indexOf(this.cascade)>=0&&(this._fixGridCollisions(p,d),this._cascadeGrid(p,d))),this._fixToGrid||(this._resizingItem.setDimensions(l,c),this._resizingItem.setPosition(_,g)),this.onResize.emit(this._resizingItem),this._resizingItem.onResizeEvent()}},t.prototype._dragStop=function(t){if(this.isDragging){this.isDragging=!1;var e=this._draggingItem.getGridPosition();this._draggingItem.setGridPosition(e),this._addToGrid(this._draggingItem),this._cascadeGrid(),this._updateSize(),this._draggingItem.stopMoving(),this._draggingItem.onDragStopEvent(),this.onDragStop.emit(this._draggingItem),this._cleanDrag(),this._placeholderRef.destroy(),this._emitOnItemChange(),this._zoomOnDrag&&this._resetZoom()}},t.prototype._resizeStop=function(t){if(this.isResizing){this.isResizing=!1;var e=this._resizingItem.getSize();this._resizingItem.setSize(e);var i=this._resizingItem.getGridPosition();this._resizingItem.setGridPosition(i),this._addToGrid(this._resizingItem),this._cascadeGrid(),this._updateSize(),this._resizingItem.stopMoving(),this._resizingItem.onResizeStopEvent(),this.onResizeStop.emit(this._resizingItem),this._cleanResize(),this._placeholderRef.destroy(),this._emitOnItemChange()}},t.prototype._cleanDrag=function(){this._draggingItem=null,this._posOffset=null,this.isDragging=!1,this._dragReady=!1},t.prototype._cleanResize=function(){this._resizingItem=null,this._resizeDirection=null,this.isResizing=!1,this._resizeReady=!1},t.prototype._calculateGridSize=function(t,e){t+=this.marginLeft+this.marginRight,e+=this.marginTop+this.marginBottom;var i=Math.max(this.minCols,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))),n=Math.max(this.minRows,Math.round(e/(this.rowHeight+this.marginTop+this.marginBottom)));return this._isWithinBoundsX({col:1,row:1},{x:i,y:n})||(i=this._maxCols),this._isWithinBoundsY({col:1,row:1},{x:i,y:n})||(n=this._maxRows),{x:i,y:n}},t.prototype._calculateGridPosition=function(t,e){var i=Math.max(1,Math.round(t/(this.colWidth+this.marginLeft+this.marginRight))+1),n=Math.max(1,Math.round(e/(this.rowHeight+this.marginTop+this.marginBottom))+1);return this._isWithinBoundsX({col:i,row:n},{x:1,y:1})||(i=this._maxCols),this._isWithinBoundsY({col:i,row:n},{x:1,y:1})||(n=this._maxRows),{col:i,row:n}},t.prototype._hasGridCollision=function(t,e){var i=this._getCollisions(t,e);return null!=i&&0!==i.length&&i.some(function(t){return!(null===t)})},t.prototype._getCollisions=function(t,e){var i=this;if(this._allowOverlap)return[];var n=[];t.col||(t.col=1),t.row||(t.row=1);var s=t.col,o=t.col+e.x,r=t.row,h=t.row+e.y;return this._itemsInGrid.forEach(function(t){var e=i._items.get(t);if(!e)return void i._itemsInGrid.delete(t);var a=e.col,l=e.col+e.sizex,c=e.row,_=e.row+e.sizey,g=s<l&&a<o,d=r<_&&c<h;g&&d&&n.push(e)}),n},t.prototype._fixGridCollisions=function(t,e){var i=this._getCollisions(t,e);if(0!==i.length){for(var n=0,s=i;n<s.length;n++){var o=s[n];this._removeFromGrid(o);var r=o.getSize(),h=o.getGridPosition(),a={col:h.col,row:h.row};"vertical"===this._collisionFixDirection?(a.row=t.row+e.y,this._isWithinBoundsY(a,r)||(a.col=t.col+e.x,a.row=1)):"horizontal"===this._collisionFixDirection&&(a.col=t.col+e.x,this._isWithinBoundsX(a,r)||(a.col=1,a.row=t.row+e.y)),o.setGridPosition(a),this._fixGridCollisions(a,r),this._addToGrid(o),o.onCascadeEvent()}this._fixGridCollisions(t,e)}},t.prototype._cascadeGrid=function(t,e){var i=this;if(!this._destroyed&&!this._allowOverlap){if(!t!=!e)throw new Error("Cannot cascade with only position and not dimensions");this.isDragging&&this._draggingItem&&!t&&!e?(t=this._draggingItem.getGridPosition(),e=this._draggingItem.getSize()):this.isResizing&&this._resizingItem&&!t&&!e&&(t=this._resizingItem.getGridPosition(),e=this._resizingItem.getSize());var n=Array.from(this._itemsInGrid,function(t){return i._items.get(t)});switch(this.cascade){case"up":case"down":n=n.sort(s.sortItemsByPositionVertical);for(var o=new Map,r=0,h=n;r<h.length;r++){var a=h[r];if(!a.isFixed){for(var l=a.getSize(),c=a.getGridPosition(),_=o.get(c.col)||1,g=1;g<l.x;g++){var d=o.get(c.col+g)||1;_=Math.max(d,_)}var m=c.col,u=c.col+l.x;if(t&&e){if(u>t.col&&m<t.col+e.x){l.y<=t.row-_||(_=Math.max(_,t.row+e.y))}}var f={col:c.col,row:_};_!==c.row&&this._isWithinBoundsY(f,l)&&(this._removeFromGrid(a),a.setGridPosition(f),a.onCascadeEvent(),this._addToGrid(a));for(var g=0;g<l.x;g++)o.set(c.col+g,_+l.y)}}break;case"left":case"right":n=n.sort(s.sortItemsByPositionHorizontal);for(var p=new Map,y=0,v=n;y<v.length;y++){for(var a=v[y],l=a.getSize(),c=a.getGridPosition(),x=p.get(c.row)||1,g=1;g<l.y;g++){var w=p.get(c.row+g)||1;x=Math.max(w,x)}var z=c.row,E=c.row+l.y;if(t&&e){if(E>t.col&&z<t.col+e.x){l.x<=t.col-x||(x=Math.max(x,t.col+e.x))}}var f={col:x,row:c.row};x!==c.col&&this._isWithinBoundsX(f,l)&&(this._removeFromGrid(a),a.setGridPosition(f),a.onCascadeEvent(),this._addToGrid(a));for(var g=0;g<l.y;g++)p.set(c.row+g,x+l.x)}}}},t.prototype._fixGridPosition=function(t,e){if(!this._hasGridCollision(t,e))return t;var i=this._maxRows,n=this._getMaxRow(),s=this._maxCols,o=this._getMaxCol(),r={col:t.col,row:t.row};if(0===s&&e.y>=i)r.col=o+1,r.row=1;else if(0===i&&e.x>=s)r.row=n+1,r.col=1;else if("vertical"===this._itemFixDirection)if(0===i){var h=this._getItemsInVerticalPath(r,e,r.row);r.row=this._getNextFittingRow(r,e,h)}else for(;r.col<=o;){var h=this._getItemsInVerticalPath(r,e,r.row),a=this._getNextFittingRow(r,e,h);if(i-a>=e.y){r.row=a;break}r.col=Math.max(r.col+1,Math.min.apply(Math,h.map(function(t){return t.col+t.sizex}))),r.row=1}else if("horizontal"===this._itemFixDirection)if(0===s){var h=this._getItemsInHorizontalPath(r,e,r.row);r.col=this._getNextFittingCol(r,e,h)}else for(;r.row<=n;){var h=this._getItemsInHorizontalPath(r,e,r.col),l=this._getNextFittingCol(r,e,h);if(s-l>=e.x){r.col=l;break}r.row=Math.max(r.row+1,Math.min.apply(Math,h.map(function(t){return t.row+t.sizey}))),r.col=1}return r},t.prototype._getNextFittingRow=function(t,e,i){for(var n=t.row,s=0,o=i;s<o.length;s++){var r=o[s];if(r.row-n>=e.y)return n;n=r.row+r.sizey}return n},t.prototype._getNextFittingCol=function(t,e,i){for(var n=t.col,s=0,o=i;s<o.length;s++){var r=o[s];if(r.col-n>=e.x)return n;n=r.col+r.sizex}return n},t.prototype._getItemsInHorizontalPath=function(t,e,i){var n=this;void 0===i&&(i=0);var s=[],o=t.row+e.y-1;return this._itemsInGrid.forEach(function(e){var r=n._items.get(e);r.col+r.sizex-1<i||r.row>o||r.row+r.sizey-1<t.row||s.push(r)}),s},t.prototype._getItemsInVerticalPath=function(t,e,i){var n=this;void 0===i&&(i=0);var s=[],o=t.col+e.x-1;return this._itemsInGrid.forEach(function(e){var r=n._items.get(e);r.row+r.sizey-1<i||r.col>o||r.col+r.sizex-1<t.col||s.push(r)}),s},t.prototype._isWithinBoundsX=function(t,e,i){return void 0===i&&(i=!1),0===this._maxCols||i&&1===t.col||t.col+e.x-1<=this._maxCols},t.prototype._fixPosToBoundsX=function(t,e){return this._isWithinBoundsX(t,e)||(t.col=Math.max(this._maxCols-(e.x-1),1),t.row++),t},t.prototype._fixSizeToBoundsX=function(t,e){return this._isWithinBoundsX(t,e)||(e.x=Math.max(this._maxCols-(t.col-1),1),e.y++),e},t.prototype._isWithinBoundsY=function(t,e,i){return void 0===i&&(i=!1),0===this._maxRows||i&&1===t.row||t.row+e.y-1<=this._maxRows},t.prototype._fixPosToBoundsY=function(t,e){return this._isWithinBoundsY(t,e)||(t.row=Math.max(this._maxRows-(e.y-1),1),t.col++),t},t.prototype._fixSizeToBoundsY=function(t,e){return this._isWithinBoundsY(t,e)||(e.y=Math.max(this._maxRows-(t.row-1),1),e.x++),e},t.prototype._isWithinBounds=function(t,e,i){return void 0===i&&(i=!1),this._isWithinBoundsX(t,e,i)&&this._isWithinBoundsY(t,e,i)},t.prototype._fixPosToBounds=function(t,e){return this._fixPosToBoundsX(this._fixPosToBoundsY(t,e),e)},t.prototype._fixSizeToBounds=function(t,e){return this._fixSizeToBoundsX(t,this._fixSizeToBoundsY(t,e))},t.prototype._addToGrid=function(t){var e=t.getGridPosition(),i=t.getSize();this._hasGridCollision(e,i)&&(this._fixGridCollisions(e,i),e=t.getGridPosition()),this._allowOverlap&&(t.zIndex=this._lastZValue++),this._itemsInGrid.add(t.uid)},t.prototype._removeFromGrid=function(t){this._itemsInGrid.delete(t.uid)},t.prototype._updateSize=function(){if(!this._destroyed){var t=this._getMaxCol(),e=this._getMaxRow();t===this._curMaxCol&&e===this._curMaxRow||(this._curMaxCol=t,this._curMaxRow=e),this._renderer.setStyle(this._ngEl.nativeElement,"width","100%"),this._elementBasedDynamicRowHeight||this._renderer.setStyle(this._ngEl.nativeElement,"height",e*(this.rowHeight+this.marginTop+this.marginBottom)+"px")}},t.prototype._getMaxRow=function(){var t=this,e=Array.from(this._itemsInGrid,function(e){var i=t._items.get(e);return i?i.row+i.sizey-1:0});return Math.max.apply(null,e)},t.prototype._getMaxCol=function(){var t=this,e=Array.from(this._itemsInGrid,function(e){var i=t._items.get(e);return i?i.col+i.sizex-1:0});return Math.max.apply(null,e)},t.prototype._getMousePosition=function(t){(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=t.touches.length>0?t.touches[0]:t.changedTouches[0]);var e=this._ngEl.nativeElement.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;return"down"===this.cascade&&(n=e.top+e.height-t.clientY),"right"===this.cascade&&(i=e.left+e.width-t.clientX),this.isDragging&&this._zoomOnDrag&&(i*=2,n*=2),{left:i,top:n}},t.prototype._getAbsoluteMousePosition=function(t){return(window.TouchEvent&&t instanceof TouchEvent||t.touches||t.changedTouches)&&(t=t.touches.length>0?t.touches[0]:t.changedTouches[0]),{left:t.clientX,top:t.clientY}},t.prototype._getContainerColumns=function(){var t=this._ngEl.nativeElement.getBoundingClientRect().width,e=this.colWidth+this.marginLeft+this.marginRight;return Math.floor(t/e)},t.prototype._getContainerRows=function(){var t=window.innerHeight-this.marginTop-this.marginBottom;return Math.floor(t/(this.rowHeight+this.marginTop+this.marginBottom))},t.prototype._getScreenMargin=function(){var t=this._ngEl.nativeElement.getBoundingClientRect().width,e=this.colWidth+this.marginLeft+this.marginRight;return Math.floor((t-this._maxCols*e)/2)},t.prototype._getItemFromPosition=function(t){var e=this;return Array.from(this._itemsInGrid,function(t){return e._items.get(t)}).sort(function(t,e){return e.zIndex-t.zIndex}).find(function(e){if(!e)return!1;var i=e.getDimensions(),n=e.getPosition();return t.left>=n.left&&t.left<n.left+i.width&&t.top>=n.top&&t.top<n.top+i.height})},t.prototype._createPlaceholder=function(t){var e=t.getGridPosition(),i=t.getSize(),s=this.componentFactoryResolver.resolveComponentFactory(n),o=t.containerRef.createComponent(s);this._placeholderRef=o;var r=o.instance;r.registerGrid(this),r.setCascadeMode(this.cascade),r.setGridPosition({col:e.col,row:e.row}),r.setSize({x:i.x,y:i.y})},t.prototype._emitOnItemChange=function(){var t=this,e=Array.from(this._itemsInGrid).map(function(e){return t._items.get(e)}).filter(function(t){return!!t}).map(function(t){return t.getEventOutput()});this.onItemChange.emit(e)},t.prototype._defineListeners=function(){var t=this._ngEl.nativeElement;this._documentMousemove$=i.fromEvent(document,"mousemove"),this._documentMouseup$=i.fromEvent(document,"mouseup"),this._mousedown$=i.fromEvent(t,"mousedown"),this._mousemove$=i.fromEvent(t,"mousemove"),this._mouseup$=i.fromEvent(t,"mouseup"),this._touchstart$=i.fromEvent(t,"touchstart"),this._touchmove$=i.fromEvent(t,"touchmove"),this._touchend$=i.fromEvent(t,"touchend")},t.prototype._enableListeners=function(){this._enabledListener||(this._enableMouseListeners(),this._isTouchDevice()&&this._enableTouchListeners(),this._enabledListener=!0)},t.prototype._disableListeners=function(){this._subscriptions.forEach(function(t){return t.unsubscribe()}),this._enabledListener=!1},t.prototype._isTouchDevice=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0},t.prototype._enableTouchListeners=function(){var t=this,e=this._touchstart$.subscribe(function(e){return t.mouseDownEventHandler(e)}),i=this._touchmove$.subscribe(function(e){return t.mouseMoveEventHandler(e)}),n=this._touchend$.subscribe(function(e){return t.mouseUpEventHandler(e)});this._subscriptions.push(e,i,n)},t.prototype._enableMouseListeners=function(){var t=this,e=this._documentMousemove$.subscribe(function(e){return t.mouseMoveEventHandler(e)}),i=this._documentMouseup$.subscribe(function(e){return t.mouseUpEventHandler(e)}),n=this._mousedown$.subscribe(function(e){return t.mouseDownEventHandler(e)}),s=this._mousemove$.subscribe(function(e){return t.mouseMoveEventHandler(e)}),o=this._mouseup$.subscribe(function(e){return t.mouseUpEventHandler(e)});this._subscriptions.push(e,i,n,s,o)},t.CONST_DEFAULT_RESIZE_DIRECTIONS=["bottomright","bottomleft","topright","topleft","right","left","bottom","top"],t.CONST_DEFAULT_CONFIG={margins:[10],draggable:!0,resizable:!0,max_cols:0,max_rows:0,visible_cols:0,visible_rows:0,col_width:250,row_height:250,cascade:"up",min_width:100,min_height:100,fix_to_grid:!1,auto_style:!0,auto_resize:!1,maintain_ratio:!1,prefer_new:!1,zoom_on_drag:!1,limit_to_screen:!1,center_to_screen:!1,resize_directions:t.CONST_DEFAULT_RESIZE_DIRECTIONS,element_based_row_height:!1,fix_item_position_direction:"cascade",fix_collision_position_direction:"cascade",allow_overlap:!1},t.ɵfac=function(i){
return new(i||t)(e.ɵɵdirectiveInject(e.KeyValueDiffers),e.ɵɵdirectiveInject(e.ElementRef),e.ɵɵdirectiveInject(e.Renderer2),e.ɵɵdirectiveInject(e.ComponentFactoryResolver))},t.ɵdir=e.ɵɵdefineDirective({type:t,selectors:[["","ngGrid",""]],hostBindings:function(t,i){1&t&&e.ɵɵlistener("resize",function(t){return i.resizeEventHandler(t)},!1,e.ɵɵresolveWindow)},inputs:{config:["ngGrid","config"]},outputs:{onDragStart:"onDragStart",onDrag:"onDrag",onDragStop:"onDragStop",onResizeStart:"onResizeStart",onResize:"onResize",onResizeStop:"onResizeStop",onItemChange:"onItemChange"}}),t}();!function(){("undefined"==typeof ngDevMode||ngDevMode)&&e.ɵsetClassMetadata(o,[{type:e.Directive,args:[{host:{"(window:resize)":"resizeEventHandler($event)"},inputs:["config: ngGrid"],selector:"[ngGrid]"}]}],function(){return[{type:e.KeyValueDiffers},{type:e.ElementRef},{type:e.Renderer2},{type:e.ComponentFactoryResolver}]},{onDragStart:[{type:e.Output}],onDrag:[{type:e.Output}],onDragStop:[{type:e.Output}],onResizeStart:[{type:e.Output}],onResize:[{type:e.Output}],onResizeStop:[{type:e.Output}],onItemChange:[{type:e.Output}]})}();var r=function(){function t(i,n,s,o,r){this._differs=i,this._ngEl=n,this._renderer=s,this._ngGrid=o,this.containerRef=r,this.onItemChange=new e.EventEmitter(!1),this.onDragStart=new e.EventEmitter,this.onDrag=new e.EventEmitter,this.onDragStop=new e.EventEmitter,this.onDragAny=new e.EventEmitter,this.onResizeStart=new e.EventEmitter,this.onResize=new e.EventEmitter,this.onResizeStop=new e.EventEmitter,this.onResizeAny=new e.EventEmitter,this.onChangeStart=new e.EventEmitter,this.onChange=new e.EventEmitter,this.onChangeStop=new e.EventEmitter,this.onChangeAny=new e.EventEmitter,this.ngGridItemChange=new e.EventEmitter,this.isFixed=!1,this.isDraggable=!0,this.isResizable=!0,this.minWidth=0,this.minHeight=0,this.uid=null,this._currentPosition={col:1,row:1},this._size={x:1,y:1},this._config=t.CONST_DEFAULT_CONFIG,this._userConfig=null,this._dragHandle=null,this._resizeHandle=null,this._borderSize=25,this._added=!1,this._maxCols=0,this._minCols=0,this._maxRows=0,this._minRows=0,this._resizeDirections=[],this._zIndex=0}return Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._renderer.setStyle(this._ngEl.nativeElement,"z-index",t.toString()),this._zIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{set:function(e){this._userConfig=e;var i=Object.assign({},t.CONST_DEFAULT_CONFIG,e);for(var n in t.CONST_DEFAULT_CONFIG)null==i[n]&&(i[n]=t.CONST_DEFAULT_CONFIG[n]);this.setConfig(i),null!=this._userConfig&&(null==this._differ&&(this._differ=this._differs.find(this._userConfig).create()),this._differ.diff(this._userConfig)),this._added||(this._added=!0,this._ngGrid.addItem(this)),this._recalculateDimensions(),this._recalculatePosition()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizex",{get:function(){return this._size.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizey",{get:function(){return this._size.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._currentPosition.col},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._currentPosition.row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCol",{get:function(){return this._currentPosition.col},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentRow",{get:function(){return this._currentPosition.row},enumerable:!1,configurable:!0}),t.prototype.onResizeStartEvent=function(){var t=this.getEventOutput();this.onResizeStart.emit(t),this.onResizeAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},t.prototype.onResizeEvent=function(){var t=this.getEventOutput();this.onResize.emit(t),this.onResizeAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},t.prototype.onResizeStopEvent=function(){var t=this.getEventOutput();this.onResizeStop.emit(t),this.onResizeAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this.onConfigChangeEvent()},t.prototype.onDragStartEvent=function(){var t=this.getEventOutput();this.onDragStart.emit(t),this.onDragAny.emit(t),this.onChangeStart.emit(t),this.onChangeAny.emit(t)},t.prototype.onDragEvent=function(){var t=this.getEventOutput();this.onDrag.emit(t),this.onDragAny.emit(t),this.onChange.emit(t),this.onChangeAny.emit(t)},t.prototype.onDragStopEvent=function(){var t=this.getEventOutput();this.onDragStop.emit(t),this.onDragAny.emit(t),this.onChangeStop.emit(t),this.onChangeAny.emit(t),this.onConfigChangeEvent()},t.prototype.onCascadeEvent=function(){this.onConfigChangeEvent()},t.prototype.ngOnInit=function(){this._renderer.addClass(this._ngEl.nativeElement,"grid-item"),this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"position","absolute"),this._recalculateDimensions(),this._recalculatePosition(),this._added||(this._added=!0,this._ngGrid.addItem(this))},t.prototype.canDrag=function(t){return!!this.isDraggable&&(!this._dragHandle||this.findHandle(this._dragHandle,t.target))},t.prototype.findHandle=function(t,e){try{for(var i=e;i&&i!==this._ngEl.nativeElement;){if(this.elementMatches(i,t))return!0;i=i.parentElement}}catch(t){}return!1},t.prototype.canResize=function(t){if(!this.isResizable)return null;if(this._resizeHandle){if("string"==typeof this._resizeHandle)return this.findHandle(this._resizeHandle,t.target)?"bottomright":null;if("object"!=typeof this._resizeHandle)return null;for(var e=0,i=this._resizeDirections;e<i.length;e++){var n=i[e];if(n in this._resizeHandle&&this.findHandle(this._resizeHandle[n],t.target))return n}return null}if(this._borderSize<=0)return null;for(var s=this._getMousePosition(t),o=0,r=this._resizeDirections;o<r.length;o++){var n=r[o];if(this.canResizeInDirection(n,s))return n}return null},t.prototype.onMouseMove=function(t){if(this._ngGrid.autoStyle)if(this._ngGrid.resizeEnable){var e=this.canResize(t),i="default";switch(e){case"bottomright":case"topleft":i="nwse-resize";break;case"topright":case"bottomleft":i="nesw-resize";break;case"top":case"bottom":i="ns-resize";break;case"left":case"right":i="ew-resize";break;default:this._ngGrid.dragEnable&&this.canDrag(t)&&(i="move")}this._renderer.setStyle(this._ngEl.nativeElement,"cursor",i)}else this._ngGrid.dragEnable&&this.canDrag(t)?this._renderer.setStyle(this._ngEl.nativeElement,"cursor","move"):this._renderer.setStyle(this._ngEl.nativeElement,"cursor","default")},t.prototype.ngOnDestroy=function(){this._added&&this._ngGrid.removeItem(this)},t.prototype.getElement=function(){return this._ngEl},t.prototype.getDragHandle=function(){return this._dragHandle},t.prototype.getResizeHandle=function(){return this._resizeHandle},t.prototype.getDimensions=function(){return{width:this._elemWidth,height:this._elemHeight}},t.prototype.getSize=function(){return this._size},t.prototype.getPosition=function(){return{left:this._elemLeft,top:this._elemTop}},t.prototype.getGridPosition=function(){return this._currentPosition},t.prototype.setConfig=function(e){this._config=e,this._payload=e.payload,this._currentPosition.col=e.col?e.col:t.CONST_DEFAULT_CONFIG.col,this._currentPosition.row=e.row?e.row:t.CONST_DEFAULT_CONFIG.row,this._size.x=e.sizex?e.sizex:t.CONST_DEFAULT_CONFIG.sizex,this._size.y=e.sizey?e.sizey:t.CONST_DEFAULT_CONFIG.sizey,this._dragHandle=e.dragHandle,this._resizeHandle=e.resizeHandle,this._borderSize=e.borderSize,this.isDraggable=!!e.draggable,this.isResizable=!!e.resizable,this.isFixed=!!e.fixed,this._resizeDirections=e.resizeDirections||this._ngGrid.resizeDirections,this._maxCols=!isNaN(e.maxCols)&&isFinite(e.maxCols)?e.maxCols:0,this._minCols=!isNaN(e.minCols)&&isFinite(e.minCols)?e.minCols:0,this._maxRows=!isNaN(e.maxRows)&&isFinite(e.maxRows)?e.maxRows:0,this._minRows=!isNaN(e.minRows)&&isFinite(e.minRows)?e.minRows:0,this.minWidth=!isNaN(e.minWidth)&&isFinite(e.minWidth)?e.minWidth:0,this.minHeight=!isNaN(e.minHeight)&&isFinite(e.minHeight)?e.minHeight:0,this._minCols>0&&this._maxCols>0&&this._minCols>this._maxCols&&(this._minCols=0),this._minRows>0&&this._maxRows>0&&this._minRows>this._maxRows&&(this._minRows=0),this._added&&this._ngGrid.updateItem(this),this._size=this.fixResize(this._size),this._recalculatePosition(),this._recalculateDimensions()},t.prototype.ngDoCheck=function(){if(null!=this._differ){var t=this._differ.diff(this._userConfig);if(null!=t)return this._applyChanges(t)}return!1},t.prototype.setSize=function(t,e){void 0===e&&(e=!0),t=this.fixResize(t),this._size=t,e&&this._recalculateDimensions(),this.onItemChange.emit(this.getEventOutput())},t.prototype.setGridPosition=function(t,e){void 0===e&&(e=!0),this._currentPosition=t,e&&this._recalculatePosition(),this.onItemChange.emit(this.getEventOutput())},t.prototype.getEventOutput=function(){return{col:this._currentPosition.col,height:this._elemHeight,left:this._elemLeft,payload:this._payload,row:this._currentPosition.row,sizex:this._size.x,sizey:this._size.y,top:this._elemTop,uid:this.uid,width:this._elemWidth}},t.prototype.setPosition=function(t,e){switch(this._cascadeMode){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"left",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",e+"px");break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"right",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",e+"px");break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"left",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",e+"px")}this._elemLeft=t,this._elemTop=e},t.prototype.setCascadeMode=function(t){switch(this._cascadeMode=t,t){case"up":case"left":default:this._renderer.setStyle(this._ngEl.nativeElement,"left",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"right":this._renderer.setStyle(this._ngEl.nativeElement,"right",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"top",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"left",null),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",null);break;case"down":this._renderer.setStyle(this._ngEl.nativeElement,"left",this._elemLeft+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"bottom",this._elemTop+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"right",null),this._renderer.setStyle(this._ngEl.nativeElement,"top",null)}},t.prototype.setDimensions=function(t,e){t<this.minWidth&&(t=this.minWidth),e<this.minHeight&&(e=this.minHeight),this._renderer.setStyle(this._ngEl.nativeElement,"width",t+"px"),this._renderer.setStyle(this._ngEl.nativeElement,"height",e+"px"),this._elemWidth=t,this._elemHeight=e},t.prototype.startMoving=function(){this._renderer.addClass(this._ngEl.nativeElement,"moving");var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"),10)+1).toString())},t.prototype.stopMoving=function(){this._renderer.addClass(this._ngEl.nativeElement,"moving");var t=window.getComputedStyle(this._ngEl.nativeElement);this._ngGrid.autoStyle&&this._renderer.setStyle(this._ngEl.nativeElement,"z-index",(parseInt(t.getPropertyValue("z-index"),10)-1).toString())},t.prototype.recalculateSelf=function(){this._recalculatePosition(),this._recalculateDimensions()},t.prototype.fixResize=function(t){return this._maxCols>0&&t.x>this._maxCols&&(t.x=this._maxCols),this._maxRows>0&&t.y>this._maxRows&&(t.y=this._maxRows),this._minCols>0&&t.x<this._minCols&&(t.x=this._minCols),this._minRows>0&&t.y<this._minRows&&(t.y=this._minRows),t.x*this._ngGrid.colWidth+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(t.x-1)<this.minWidth&&(t.x=Math.ceil((this.minWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft)/(this._ngGrid.colWidth+this._ngGrid.marginRight+this._ngGrid.marginLeft))),t.y*this._ngGrid.rowHeight+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(t.y-1)<this.minHeight&&(t.y=Math.ceil((this.minHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop)/(this._ngGrid.rowHeight+this._ngGrid.marginBottom+this._ngGrid.marginTop))),t},t.prototype.elementMatches=function(t,e){if(!t)return!1;if(t.matches)return t.matches(e);if(t.oMatchesSelector)return t.oMatchesSelector(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.mozMatchesSelector)return t.mozMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(!t.document||!t.ownerDocument)return!1;for(var i=(t.document||t.ownerDocument).querySelectorAll(e),n=i.length-1;n>=0;n--)if(i.item(n)===t)return!0;return!1},t.prototype._recalculatePosition=function(){var t=(this._ngGrid.colWidth+this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._currentPosition.col-1)+this._ngGrid.marginLeft+this._ngGrid.screenMargin,e=(this._ngGrid.rowHeight+this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._currentPosition.row-1)+this._ngGrid.marginTop;this.setPosition(t,e)},t.prototype._recalculateDimensions=function(){this._size.x<this._ngGrid.minCols&&(this._size.x=this._ngGrid.minCols),this._size.y<this._ngGrid.minRows&&(this._size.y=this._ngGrid.minRows);var t=this._ngGrid.colWidth*this._size.x+(this._ngGrid.marginLeft+this._ngGrid.marginRight)*(this._size.x-1),e=this._ngGrid.rowHeight*this._size.y+(this._ngGrid.marginTop+this._ngGrid.marginBottom)*(this._size.y-1),i=Math.max(this.minWidth,this._ngGrid.minWidth,t),n=Math.max(this.minHeight,this._ngGrid.minHeight,e);this.setDimensions(i,n)},t.prototype._getMousePosition=function(t){if(t.originalEvent&&t.originalEvent.touches){var e=t.originalEvent;t=e.touches.length?e.touches[0]:e.changedTouches.length?e.changedTouches[0]:t}else t.touches&&(t=t.touches.length?t.touches[0]:t.changedTouches.length?t.changedTouches[0]:t);var i=this._ngEl.nativeElement.getBoundingClientRect();return{left:t.clientX-i.left,top:t.clientY-i.top}},t.prototype._applyChanges=function(t){var e=this,i=!1,n=function(t){e._config[t.key]!==t.currentValue&&(e._config[t.key]=t.currentValue,i=!0)};return t.forEachAddedItem(n),t.forEachChangedItem(n),t.forEachRemovedItem(function(t){i=!0,delete e._config[t.key]}),i&&this.setConfig(this._config),i},t.prototype.onConfigChangeEvent=function(){null!==this._userConfig&&(this._config.sizex=this._userConfig.sizex=this._size.x,this._config.sizey=this._userConfig.sizey=this._size.y,this._config.col=this._userConfig.col=this._currentPosition.col,this._config.row=this._userConfig.row=this._currentPosition.row,this.ngGridItemChange.emit(this._userConfig))},t.prototype.canResizeInDirection=function(t,e){switch(t){case"bottomright":return e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize&&e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize;case"bottomleft":return e.left<this._borderSize&&e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize;case"topright":return e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize&&e.top<this._borderSize;case"topleft":return e.left<this._borderSize&&e.top<this._borderSize;case"right":return e.left<this._elemWidth&&e.left>this._elemWidth-this._borderSize;case"left":return e.left<this._borderSize;case"bottom":return e.top<this._elemHeight&&e.top>this._elemHeight-this._borderSize;case"top":return e.top<this._borderSize;default:return!1}},t.CONST_DEFAULT_CONFIG={uid:null,col:1,row:1,sizex:1,sizey:1,dragHandle:null,resizeHandle:null,fixed:!1,draggable:!0,resizable:!0,borderSize:25,resizeDirections:null},t.ɵfac=function(i){return new(i||t)(e.ɵɵdirectiveInject(e.KeyValueDiffers),e.ɵɵdirectiveInject(e.ElementRef),e.ɵɵdirectiveInject(e.Renderer2),e.ɵɵdirectiveInject(o),e.ɵɵdirectiveInject(e.ViewContainerRef))},t.ɵdir=e.ɵɵdefineDirective({type:t,selectors:[["","ngGridItem",""]],inputs:{config:["ngGridItem","config"]},outputs:{onItemChange:"onItemChange",onDragStart:"onDragStart",onDrag:"onDrag",onDragStop:"onDragStop",onDragAny:"onDragAny",onResizeStart:"onResizeStart",onResize:"onResize",onResizeStop:"onResizeStop",onResizeAny:"onResizeAny",onChangeStart:"onChangeStart",onChange:"onChange",onChangeStop:"onChangeStop",onChangeAny:"onChangeAny",ngGridItemChange:"ngGridItemChange"}}),t}();!function(){("undefined"==typeof ngDevMode||ngDevMode)&&e.ɵsetClassMetadata(r,[{type:e.Directive,args:[{inputs:["config: ngGridItem"],selector:"[ngGridItem]"}]}],function(){return[{type:e.KeyValueDiffers},{type:e.ElementRef},{type:e.Renderer2},{type:o},{type:e.ViewContainerRef}]},{onItemChange:[{type:e.Output}],onDragStart:[{type:e.Output}],onDrag:[{type:e.Output}],onDragStop:[{type:e.Output}],onDragAny:[{type:e.Output}],onResizeStart:[{type:e.Output}],onResize:[{type:e.Output}],onResizeStop:[{type:e.Output}],onResizeAny:[{type:e.Output}],onChangeStart:[{type:e.Output}],onChange:[{type:e.Output}],onChangeStop:[{type:e.Output}],onChangeAny:[{type:e.Output}],ngGridItemChange:[{type:e.Output}]})}();var h=function(){function t(){}return t.ɵfac=function(e){return new(e||t)},t.ɵmod=e.ɵɵdefineNgModule({type:t}),t.ɵinj=e.ɵɵdefineInjector({}),t}();!function(){("undefined"==typeof ngDevMode||ngDevMode)&&e.ɵsetClassMetadata(h,[{type:e.NgModule,args:[{declarations:[o,r,n],entryComponents:[n],exports:[o,r]}]}],null,null)}(),function(){("undefined"==typeof ngJitMode||ngJitMode)&&e.ɵɵsetNgModuleScope(h,{declarations:[o,r,n],exports:[o,r]})}(),t.NgGrid=o,t.NgGridItem=r,t.NgGridPlaceholder=n,t.NgGridModule=h,Object.defineProperty(t,"__esModule",{value:!0})});